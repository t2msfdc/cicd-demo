# Unique name for this workflow
name: My CI/CD pipeline

# Definition when the workflow should run
on:
    pull_request:
        types: [opened, edited, synchronize, reopened]

# Jobs to be executed
jobs:
    # Try to iniate something
    initialization:
        runs-on: ubuntu-latest
        steps:
          - run: echo "ğŸ‰ The job was automatically triggered by a ${{ github.event_name }} event."
          - run: echo "ğŸ§ This job is now running on a ${{ runner.os }} server hosted by GitHub!"
          - run: echo "ğŸ” The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
          - name: Check out repository code
            uses: actions/checkout@v4
          - run: echo "ğŸ’¡ The ${{ github.repository }} repository has been cloned to the runner."
          - run: echo "ğŸ–¥ï¸ The workflow is now ready to test your code on the runner."
          - name: List files in the repository
            run: |
              ls ${{ github.workspace }}
          - run: echo "ğŸ This job's status is ${{ job.status }}."
           
    # Verify source using PMD
    pmd-verification:
        runs-on: ubuntu-latest
        steps:
            # Install PMD
            - name: Install PMD
              run: wget https://github.com/pmd/pmd/releases/download/pmd_releases%2F6.51.0/pmd-bin-6.51.0.zip && unzip pmd-bin-6.51.0.zip

            # Checkout the code in the pull request
            - name: 'Checkout source code'
              uses: actions/checkout@v3

            # Execute PMD
            - name: Execute PMD
              run: pmd-bin-6.51.0/bin/run.sh pmd --minimum-priority 2 -R custom-apex-rules.xml -d force-app -f text -l apex

